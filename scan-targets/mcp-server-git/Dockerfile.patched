FROM python:3.12-slim

RUN apt-get update && apt-get install -y git && rm -rf /var/lib/apt/lists/*

RUN pip install "mcp-server-git==2026.1.14"

RUN mkdir -p /repos/test-repo && \
    cd /repos/test-repo && \
    git init && \
    git config user.email "test@test.com" && \
    git config user.name "Test" && \
    echo "# Test Repository" > README.md && \
    git add . && \
    git commit -m "initial commit"

RUN mkdir -p /sensitive-data && \
    echo "database_password=hunter2" > /sensitive-data/secrets.txt

ENTRYPOINT ["python", "-m", "mcp_server_git", "--repository", "/repos/test-repo"]
